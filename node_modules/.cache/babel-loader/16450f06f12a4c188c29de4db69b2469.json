{"ast":null,"code":"import _slicedToArray from\"/Users/krithikasudupa/Documents/ipm-marketplace-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*\n#\n# Copyright 2020- IBM Inc. All rights reserved\n# SPDX-License-Identifier: Apache2.0\n#\n*/import React,{useState,useEffect}from\"react\";import axios from\"axios\";import\"./Quote.css\";import{ArrowLeft32}from\"@carbon/icons-react\";import{Loading}from\"carbon-components-react\";import{Grid,Row,Column,Button,Table,TableHead,TableRow,TableHeader,TableContainer,TableBody,TableCell,Tile,Link}from\"carbon-components-react\";import ContainerComponent from\"./../Layout/Container/ContainerComponent\";var parseCookies=function parseCookies(cookies){var list={};cookies&&cookies.split(\";\").forEach(function(cookie){var parts=cookie.split(\"=\");list[parts.shift().trim()]=decodeURI(parts.join(\"=\"));});return list;};var hostname=process.env.NODE_ENV===\"development\"?\"http://localhost:3000\":window.location.origin;export default function QuoteComponent(props){var _infoObj$data,_config$items;var searchParams=new URLSearchParams(props.location.search);var ipmConfigID=searchParams.get(\"ipmConfigID\");var backLink=searchParams.get(\"back\");var _useState=useState({status:true,msg:\"Preparing quote... please wait! \"}),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoader=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),config=_useState4[0],setConfig=_useState4[1];var _useState5=useState({status:null,message:\"\"}),_useState6=_slicedToArray(_useState5,2),infoObj=_useState6[0],setInfo=_useState6[1];var loaderProps={active:true,withOverlay:true,small:false,description:\"Loader\",className:\"loader\"};var cookies=parseCookies(document.cookie);var jwttoken=cookies.jwttoken;var headers={Authorization:\"Bearer \"+jwttoken};useEffect(function(){getData(hostname);},[]);var getData=function getData(host){axios.get(\"\".concat(host,\"/partner/quote/data?ipmConfigID=\")+ipmConfigID,{headers:headers}).then(function(response){if(response.data.errorMessage){setInfo({status:\"error\",message:response.data.errorMessage,data:response.data});}else{resetInfo();setConfig(response.data);}}).catch(function(error){var _error$response$data;setInfo({status:\"error\",message:((_error$response$data=error.response.data)===null||_error$response$data===void 0?void 0:_error$response$data.errorMessage)?error.response.data.errorMessage:\"Something went wrong!\",data:error});}).finally(function(){closeLoader();});};var closeLoader=function closeLoader(){setLoader({status:false,msg:\"\"});};var resetInfo=function resetInfo(){setInfo({status:null,message:\"\",data:null});};var handleCreateOrder=function handleCreateOrder(ipmConfigID){setLoader({status:true,msg:\"Creating order... please wait!\"});var url=\"\".concat(hostname,\"/partner/product/order/\").concat(ipmConfigID);var orderReferenceNumber=sessionStorage.getItem('or');if(orderReferenceNumber){url=\"\".concat(url,\"/\").concat(orderReferenceNumber);}axios.post(url,{headers:headers}).then(function(response){if(response.data.errorMessage){setInfo({status:\"error\",message:response.data.errorMessage,data:response.data});}else{setInfo({status:\"success\",message:response.data.message,data:response.data});}}).catch(function(error){var _error$response$data2;setInfo({status:\"error\",message:((_error$response$data2=error.response.data)===null||_error$response$data2===void 0?void 0:_error$response$data2.errorMessage)?error.response.data.errorMessage:\"Something went wrong!\",data:error});}).finally(function(){closeLoader();});};var handleRedirectBack=function handleRedirectBack(backLink){//redirect back\nwindow.location.assign(backLink);};var buttonProps=function buttonProps(ipmConfigID){return{disabled:infoObj.status,tooltipAlignment:\"center\",style:{float:\"right\"},onClick:function onClick(){return handleCreateOrder(ipmConfigID);}};};var backLinkProps=function backLinkProps(backLink){return{className:\"back--link\",inline:true,onClick:function onClick(){return handleRedirectBack(backLink);}};};var renderStatusMessages=function renderStatusMessages(info){if(info.status){switch(true){case info.data.hasOwnProperty(\"orderReferenceNumber\"):return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(info.status,\"--status info--section\")},/*#__PURE__*/React.createElement(\"span\",null,\"Order number \",info.data.orderReferenceNumber,\" has been created succesfully!\"));default:return/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(info.status,\"--status info--section\")},/*#__PURE__*/React.createElement(\"span\",null,info.message));}}else{return null;}};return/*#__PURE__*/React.createElement(ContainerComponent,null,/*#__PURE__*/React.createElement(\"div\",{className:\"margin-top25\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"quote--title\"},loading.status?loading.msg:\"Quote\")),renderStatusMessages(infoObj),loading.status?/*#__PURE__*/React.createElement(Loading,loaderProps):((_infoObj$data=infoObj.data)===null||_infoObj$data===void 0?void 0:_infoObj$data.errorCode)===\"MP1808E\"?null:/*#__PURE__*/React.createElement(Grid,null,backLink?/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Column,{md:12,className:\"margin-top25\"},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(Link,backLinkProps(backLink),/*#__PURE__*/React.createElement(ArrowLeft32,null),/*#__PURE__*/React.createElement(\"span\",null,\"Back\"))))):null,config.contacts?/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Column,{sm:12,md:12,lg:12,className:\"margin-top25\"},/*#__PURE__*/React.createElement(Tile,null,/*#__PURE__*/React.createElement(\"h4\",null,\"Contact\"))),/*#__PURE__*/React.createElement(Column,{md:2},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,\"Name:\",\" \",config.contacts.firstName+\" \"+config.contacts.lastName))),/*#__PURE__*/React.createElement(Column,{md:2},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,\"Email: \",config.contacts.email,\" \")))):null,/*#__PURE__*/React.createElement(React.Fragment,null,config.provisioning?/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Column,{sm:12,md:12,lg:12,className:\"margin-top25\"},/*#__PURE__*/React.createElement(Tile,null,/*#__PURE__*/React.createElement(\"h4\",null,\"Provision Details\"))),Object.keys(config.provisioning).map(function(provisionField,index){return/*#__PURE__*/React.createElement(Column,{md:2,key:index},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,provisionField,\":\",config.provisioning[provisionField])));})):null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Column,{sm:12,md:12,lg:12,className:\"margin-top25\"},/*#__PURE__*/React.createElement(Tile,null,/*#__PURE__*/React.createElement(\"h4\",null,\"Other Details\"))),/*#__PURE__*/React.createElement(Column,{md:2},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,\"IPM Config ID: \",config.ipmConfigID))),/*#__PURE__*/React.createElement(Column,{md:2},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,\"Billing Terms: \",config.billing))),/*#__PURE__*/React.createElement(Column,{md:2},/*#__PURE__*/React.createElement(Tile,{light:true},/*#__PURE__*/React.createElement(\"span\",null,\"Subscription Terms: \",config.terms)))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Column,null,/*#__PURE__*/React.createElement(TableContainer,{className:\"margin-top25\",title:\"Summary\"},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableHeader,null,\"ID\"),/*#__PURE__*/React.createElement(TableHeader,null,\"Quantity\"),/*#__PURE__*/React.createElement(TableHeader,null,\"Partner Debit Price\"),/*#__PURE__*/React.createElement(TableHeader,null,\"Customer Debit Price\"),/*#__PURE__*/React.createElement(TableHeader,null,\"Customer Credit Price\"),/*#__PURE__*/React.createElement(TableHeader,null,\"Price\"))),/*#__PURE__*/React.createElement(TableBody,null,(_config$items=config.items)===null||_config$items===void 0?void 0:_config$items.map(function(item,index){var _item$pricingEstimate,_item$pricingEstimate2,_item$pricingEstimate3,_item$pricingEstimate4;return/*#__PURE__*/React.createElement(TableRow,{key:index},/*#__PURE__*/React.createElement(TableCell,null,item.partIdentifier),/*#__PURE__*/React.createElement(TableCell,null,item.attributes.item_qty),/*#__PURE__*/React.createElement(TableCell,null,(_item$pricingEstimate=item.pricingEstimate)===null||_item$pricingEstimate===void 0?void 0:_item$pricingEstimate.debit.partnerExtendedPrice),/*#__PURE__*/React.createElement(TableCell,null,(_item$pricingEstimate2=item.pricingEstimate)===null||_item$pricingEstimate2===void 0?void 0:_item$pricingEstimate2.debit.suggestedEndCustomerPrice),/*#__PURE__*/React.createElement(TableCell,null,(_item$pricingEstimate3=item.pricingEstimate)===null||_item$pricingEstimate3===void 0?void 0:_item$pricingEstimate3.credit.partnerExtendedPrice),/*#__PURE__*/React.createElement(TableCell,null,((_item$pricingEstimate4=item.pricingEstimate)===null||_item$pricingEstimate4===void 0?void 0:_item$pricingEstimate4.debit.suggestedEndCustomerPrice)?item.pricingEstimate.debit.suggestedEndCustomerPrice+\" \"+config.currency:\"Free\"));})))))),/*#__PURE__*/React.createElement(Row,{className:\"margin-top25\"},/*#__PURE__*/React.createElement(Column,{lg:8}),/*#__PURE__*/React.createElement(Column,{lg:2},/*#__PURE__*/React.createElement(\"span\",{className:\"total--price\"},\"Total price: \",config.totalPrice,\" \",config.currency)),/*#__PURE__*/React.createElement(Column,{lg:2},/*#__PURE__*/React.createElement(Button,buttonProps(ipmConfigID),\"Create Order\"))))));}","map":{"version":3,"sources":["/Users/krithikasudupa/Documents/ipm-marketplace-app/src/components/Quote/QuoteComponent.js"],"names":["React","useState","useEffect","axios","ArrowLeft32","Loading","Grid","Row","Column","Button","Table","TableHead","TableRow","TableHeader","TableContainer","TableBody","TableCell","Tile","Link","ContainerComponent","parseCookies","cookies","list","split","forEach","cookie","parts","shift","trim","decodeURI","join","hostname","process","env","NODE_ENV","window","location","origin","QuoteComponent","props","searchParams","URLSearchParams","search","ipmConfigID","get","backLink","status","msg","loading","setLoader","config","setConfig","message","infoObj","setInfo","loaderProps","active","withOverlay","small","description","className","document","jwttoken","headers","Authorization","getData","host","then","response","data","errorMessage","resetInfo","catch","error","finally","closeLoader","handleCreateOrder","url","orderReferenceNumber","sessionStorage","getItem","post","handleRedirectBack","assign","buttonProps","disabled","tooltipAlignment","style","float","onClick","backLinkProps","inline","renderStatusMessages","info","hasOwnProperty","errorCode","contacts","firstName","lastName","email","provisioning","Object","keys","map","provisionField","index","billing","terms","items","item","partIdentifier","attributes","item_qty","pricingEstimate","debit","partnerExtendedPrice","suggestedEndCustomerPrice","credit","currency","totalPrice"],"mappings":"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","sourcesContent":["/*\n#\n# Copyright 2020- IBM Inc. All rights reserved\n# SPDX-License-Identifier: Apache2.0\n#\n*/\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./Quote.css\";\nimport { ArrowLeft32 } from \"@carbon/icons-react\";\nimport { Loading } from \"carbon-components-react\";\nimport {\n  Grid,\n  Row,\n  Column,\n  Button,\n  Table,\n  TableHead,\n  TableRow,\n  TableHeader,\n  TableContainer,\n  TableBody,\n  TableCell,\n  Tile,\n  Link,\n} from \"carbon-components-react\";\nimport ContainerComponent from \"./../Layout/Container/ContainerComponent\";\n\nconst parseCookies = (cookies) => {\n  let list = {};\n\n  cookies &&\n    cookies.split(\";\").forEach(function (cookie) {\n      const parts = cookie.split(\"=\");\n      list[parts.shift().trim()] = decodeURI(parts.join(\"=\"));\n    });\n\n  return list;\n};\n\nconst hostname =\n  process.env.NODE_ENV === \"development\"\n    ? \"http://localhost:3000\"\n    : window.location.origin;\n\nexport default function QuoteComponent(props) {\n  const searchParams = new URLSearchParams(props.location.search);\n  const ipmConfigID = searchParams.get(\"ipmConfigID\");\n  const backLink = searchParams.get(\"back\");\n\n  const [loading, setLoader] = useState({\n    status: true,\n    msg: \"Preparing quote... please wait! \",\n  });\n  const [config, setConfig] = useState({});\n  const [infoObj, setInfo] = useState({ status: null, message: \"\" });\n\n  const loaderProps = {\n    active: true,\n    withOverlay: true,\n    small: false,\n    description: \"Loader\",\n    className: \"loader\",\n  };\n\n  const cookies = parseCookies(document.cookie);\n  const { jwttoken } = cookies;\n\n  const headers = {\n    Authorization: \"Bearer \" + jwttoken,\n  };\n\n  useEffect(() => {\n    getData(hostname);\n  }, []);\n\n  const getData = (host) => {\n    axios\n      .get(`${host}/partner/quote/data?ipmConfigID=` + ipmConfigID, {\n        headers,\n      })\n      .then((response) => {\n        if (response.data.errorMessage) {\n          setInfo({\n            status: \"error\",\n            message: response.data.errorMessage,\n            data: response.data,\n          });\n        } else {\n          resetInfo();\n          setConfig(response.data);\n        }\n      })\n      .catch((error) => {\n        setInfo({\n          status: \"error\",\n          message: error.response.data?.errorMessage ? error.response.data.errorMessage : \"Something went wrong!\",\n          data: error,\n        });\n      })\n      .finally(() => {\n        closeLoader();\n      });\n  };\n\n  const closeLoader = () => {\n    setLoader({ status: false, msg: \"\" });\n  };\n\n  const resetInfo = () => {\n    setInfo({\n      status: null,\n      message: \"\",\n      data: null,\n    });\n  };\n\n  const handleCreateOrder = (ipmConfigID) => {\n    setLoader({ status: true, msg: \"Creating order... please wait!\" });\n\n    let url = `${hostname}/partner/product/order/${ipmConfigID}`;\n    const orderReferenceNumber = sessionStorage.getItem('or');\n\n    if (orderReferenceNumber) {\n      url = `${url}/${orderReferenceNumber}`\n    }\n\n    axios\n      .post(url, {\n        headers,\n      })\n      .then((response) => {\n        if (response.data.errorMessage) {\n          setInfo({\n            status: \"error\",\n            message: response.data.errorMessage,\n            data: response.data,\n          });\n        } else {\n          setInfo({\n            status: \"success\",\n            message: response.data.message,\n            data: response.data,\n          });\n        }\n      })\n      .catch((error) => {\n        setInfo({\n          status: \"error\",\n          message: error.response.data?.errorMessage ? error.response.data.errorMessage : \"Something went wrong!\",\n          data: error,\n        });\n      })\n      .finally(() => {\n        closeLoader();\n      });\n  };\n\n  const handleRedirectBack = (backLink) => {\n      //redirect back\n      window.location.assign(backLink);\n  };\n\n  const buttonProps = (ipmConfigID) => {\n    return {\n      disabled: infoObj.status,\n      tooltipAlignment: \"center\",\n      style: { float: \"right\" },\n      onClick: () => handleCreateOrder(ipmConfigID),\n    };\n  };\n\n  const backLinkProps = (backLink) => {\n    return {\n      className: \"back--link\",\n      inline: true,\n      onClick: () => handleRedirectBack(backLink),\n    };\n  };\n\n  const renderStatusMessages = (info) => {\n    if (info.status) {\n      switch (true) {\n        case info.data.hasOwnProperty(\"orderReferenceNumber\"):\n          return (\n            <div className={`${info.status}--status info--section`}>\n              <span>\n                Order number {info.data.orderReferenceNumber} has been created\n                succesfully!\n              </span>\n            </div>\n          );\n        default:\n          return (\n            <div className={`${info.status}--status info--section`}>\n              <span>{info.message}</span>\n            </div>\n          );\n      }\n    } else {\n      return null;\n    }\n  };\n\n  return (\n    <ContainerComponent>\n      <div className=\"margin-top25\">\n        <h3 className=\"quote--title\">\n          {loading.status ? loading.msg : \"Quote\"}\n        </h3>\n      </div>\n      {renderStatusMessages(infoObj)}\n      {loading.status ? (\n        <Loading {...loaderProps} />\n      ) : infoObj.data?.errorCode === \"MP1808E\" ? null : (\n        <Grid>\n          {backLink ? <Row>\n            <Column md={12} className=\"margin-top25\">\n              <Tile light={true}>\n                <Link {...backLinkProps(backLink)}>\n                  <ArrowLeft32 />\n                  <span>Back</span>\n                </Link>\n              </Tile>\n            </Column>\n          </Row> : null}\n          \n          {config.contacts ? (\n            <Row>\n              <Column sm={12} md={12} lg={12} className=\"margin-top25\">\n                <Tile>\n                  <h4>Contact</h4>\n                </Tile>\n              </Column>\n              <Column md={2}>\n                <Tile light={true}>\n                  <span>\n                    Name:{\" \"}\n                    {config.contacts.firstName + \" \" + config.contacts.lastName}\n                  </span>\n                </Tile>\n              </Column>\n              <Column md={2}>\n                <Tile light={true}>\n                  <span>Email: {config.contacts.email} </span>\n                </Tile>\n              </Column>\n            </Row>\n          ) : null}\n\n          <>\n            {config.provisioning ? (\n              <Row>\n                <Column sm={12} md={12} lg={12} className=\"margin-top25\">\n                  <Tile>\n                    <h4>Provision Details</h4>\n                  </Tile>\n                </Column>\n                {Object.keys(config.provisioning).map(\n                  (provisionField, index) => (\n                    <Column md={2} key={index}>\n                      <Tile light={true}>\n                        <span>\n                          {provisionField}:{config.provisioning[provisionField]}\n                        </span>\n                      </Tile>\n                    </Column>\n                  )\n                )}\n              </Row>\n            ) : null}\n            <Row>\n              <Column sm={12} md={12} lg={12} className=\"margin-top25\">\n                <Tile>\n                  <h4>Other Details</h4>\n                </Tile>\n              </Column>\n              <Column md={2}>\n                <Tile light={true}>\n                  <span>IPM Config ID: {config.ipmConfigID}</span>\n                </Tile>\n              </Column>\n              <Column md={2}>\n                <Tile light={true}>\n                  <span>Billing Terms: {config.billing}</span>\n                </Tile>\n              </Column>\n              <Column md={2}>\n                <Tile light={true}>\n                  <span>Subscription Terms: {config.terms}</span>\n                </Tile>\n              </Column>\n            </Row>\n            <Row>\n              <Column>\n                <TableContainer className=\"margin-top25\" title=\"Summary\">\n                  <Table>\n                    <TableHead>\n                      <TableRow>\n                        <TableHeader>ID</TableHeader>\n                        <TableHeader>Quantity</TableHeader>\n                        <TableHeader>Partner Debit Price</TableHeader>\n                        <TableHeader>Customer Debit Price</TableHeader>\n                        <TableHeader>Customer Credit Price</TableHeader>\n                        <TableHeader>Price</TableHeader>\n                      </TableRow>\n                    </TableHead>\n                    <TableBody>\n                      {config.items?.map((item, index) => (\n                        <TableRow key={index}>\n                          <TableCell>{item.partIdentifier}</TableCell>\n                          <TableCell>{item.attributes.item_qty}</TableCell>\n                          <TableCell>{item.pricingEstimate?.debit.partnerExtendedPrice}</TableCell>\n                          <TableCell>{item.pricingEstimate?.debit.suggestedEndCustomerPrice}</TableCell>\n                          <TableCell>{item.pricingEstimate?.credit.partnerExtendedPrice}</TableCell>\n                          <TableCell>\n                            {item.pricingEstimate?.debit\n                              .suggestedEndCustomerPrice\n                              ? item.pricingEstimate.debit\n                                  .suggestedEndCustomerPrice +\n                                \" \" +\n                                config.currency\n                              : \"Free\"}\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </TableContainer>\n              </Column>\n            </Row>\n            <Row className=\"margin-top25\">\n              <Column lg={8}></Column>\n              <Column lg={2}>\n                <span className=\"total--price\">\n                  Total price: {config.totalPrice} {config.currency}\n                </span>\n              </Column>\n              <Column lg={2}>\n                <Button {...buttonProps(ipmConfigID)}>Create Order</Button>\n              </Column>\n            </Row>\n          </>\n        </Grid>\n      )}\n    </ContainerComponent>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}