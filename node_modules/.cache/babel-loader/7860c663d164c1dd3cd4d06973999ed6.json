{"ast":null,"code":"import _slicedToArray from\"/Users/krithikasudupa/Documents/ipm-marketplace-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*\n#\n# Copyright 2020- IBM Inc. All rights reserved\n# SPDX-License-Identifier: Apache2.0\n#\n*/import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{Table,TableHead,TableRow,TableHeader,TableBody,TableCell,Button,TableContainer,DataTableSkeleton,InlineNotification,Loading}from\"carbon-components-react\";import ContainerComponent from\"./../Layout/Container/ContainerComponent\";import\"./Plans.css\";export default function PlansComponent(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),plans=_useState2[0],setPlans=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoader=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),spinner=_useState6[0],setSpinner=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),clickedButton=_useState8[0],setClickedButton=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),productName=_useState12[0],setProductName=_useState12[1];var urlProductID=props.match.params.productID;var headers=[\"Product\",\"Description\",\"\"];var hostname=process.env.NODE_ENV===\"development\"?\"http://localhost:3000\":window.location.origin;useEffect(function(){return getPlans();},[]);/**\n     */var getPlans=function getPlans(){axios.get(\"\".concat(hostname,\"/partner/product/\").concat(urlProductID,\"/plans/data\")).then(function(response){setLoader(false);if(response.data){var _plans=response.data.plans.filter(function(data){return data.hasOwnProperty(\"supportedByIbmConfigurator\");});setPlans(_plans);}}).catch(function(err){return console.log(err);});};/**\n     * @param  {} product\n     * @param  {} buttonId\n     */var redirectToPurchase=function redirectToPurchase(product,buttonId){setProductName(product.name);setClickedButton(buttonId);setError(false);setSpinner(true);//order reference number not used on purchase flow,\n// if there are any ORN left in session from previous subscrition actions... - remove them\nsessionStorage.removeItem(\"or\");axios.post(\"\".concat(hostname,\"/partner/product/\").concat(urlProductID,\"/configure/\").concat(product.id,\"/\").concat(navigator.language)).then(function(res){if(res.data.redirectUrl){window.open(res.data.redirectUrl);}else{setError(true);}setSpinner(false);}).catch(function(error){console.log(error);});};/**\n     * @param  {} product\n     */var buttonProps=function buttonProps(product){return{size:\"small\",tooltipAlignment:\"center\",onClick:function onClick(){return redirectToPurchase(product,product.id+\"_PB\");},className:\"purchase-button\"};};var skeletTableProps=function skeletTableProps(){return{headers:headers,columnCount:3,rowCount:20,zebra:true,compact:false,showHeader:true,showToolbar:false};};var loadingProps=function loadingProps(){return{active:spinner,withOverlay:false,small:true,description:\"\"};};var notificationProps=function notificationProps(){return{kind:\"error\",lowContrast:false,role:\"alert\",title:productName+\" is not supported.\",subtitle:\"Please try again.\",iconDescription:\"describes the close button\",statusIconDescription:\"describes the status icon\",hideCloseButton:false,onCloseButtonClick:function onCloseButtonClick(){return _onCloseButtonClick();}};};var _onCloseButtonClick=function _onCloseButtonClick(){return setError(false);};return/*#__PURE__*/React.createElement(ContainerComponent,null,error&&/*#__PURE__*/React.createElement(InlineNotification,notificationProps()),loading?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{width:\"auto\"}},/*#__PURE__*/React.createElement(DataTableSkeleton,skeletTableProps()),/*#__PURE__*/React.createElement(\"br\",null))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(TableContainer,{title:\"Plans\",description:\"Click configure to build desired configuration and order.\"},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,headers.map(function(header){return/*#__PURE__*/React.createElement(TableHeader,{key:header},header);}),/*#__PURE__*/React.createElement(TableHeader,null))),/*#__PURE__*/React.createElement(TableBody,null,plans.map(function(plan){return/*#__PURE__*/React.createElement(TableRow,{key:plan.id},/*#__PURE__*/React.createElement(TableCell,null,plan.name),/*#__PURE__*/React.createElement(TableCell,null,plan.description),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(Button,buttonProps(plan),\"Purchase\",\" \",spinner&&plan.id+\"_PB\"===clickedButton&&/*#__PURE__*/React.createElement(Loading,Object.assign({},loadingProps(),{className:\"some-class\"})))));}))))));}","map":{"version":3,"sources":["/Users/krithikasudupa/Documents/ipm-marketplace-app/src/components/Plans/PlansComponent.js"],"names":["React","useState","useEffect","axios","Table","TableHead","TableRow","TableHeader","TableBody","TableCell","Button","TableContainer","DataTableSkeleton","InlineNotification","Loading","ContainerComponent","PlansComponent","props","plans","setPlans","loading","setLoader","spinner","setSpinner","clickedButton","setClickedButton","error","setError","productName","setProductName","urlProductID","match","params","productID","headers","hostname","process","env","NODE_ENV","window","location","origin","getPlans","get","then","response","data","filter","hasOwnProperty","catch","err","console","log","redirectToPurchase","product","buttonId","name","sessionStorage","removeItem","post","id","navigator","language","res","redirectUrl","open","buttonProps","size","tooltipAlignment","onClick","className","skeletTableProps","columnCount","rowCount","zebra","compact","showHeader","showToolbar","loadingProps","active","withOverlay","small","description","notificationProps","kind","lowContrast","role","title","subtitle","iconDescription","statusIconDescription","hideCloseButton","onCloseButtonClick","width","map","header","plan"],"mappings":"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","sourcesContent":["/*\n#\n# Copyright 2020- IBM Inc. All rights reserved\n# SPDX-License-Identifier: Apache2.0\n#\n*/\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nimport {\n    Table,\n    TableHead,\n    TableRow,\n    TableHeader,\n    TableBody,\n    TableCell,\n    Button,\n    TableContainer,\n    DataTableSkeleton,\n    InlineNotification,\n    Loading,\n} from \"carbon-components-react\";\n\nimport ContainerComponent from \"./../Layout/Container/ContainerComponent\";\n\nimport \"./Plans.css\";\n\nexport default function PlansComponent(props) {\n    const [plans, setPlans] = useState([]);\n    const [loading, setLoader] = useState(true);\n    const [spinner, setSpinner] = useState(false);\n    const [clickedButton, setClickedButton] = useState(\"\");\n    const [error, setError] = useState(false);\n    const [productName, setProductName] = useState(\"\");\n\n    const urlProductID = props.match.params.productID;\n    const headers = [\"Product\", \"Description\", \"\"];\n\n    const hostname =\n        process.env.NODE_ENV === \"development\"\n            ? \"http://localhost:3000\"\n            : window.location.origin;\n\n    useEffect(() => getPlans(), []);\n\n    /**\n     */\n    const getPlans = () => {\n        axios\n            .get(`${hostname}/partner/product/${urlProductID}/plans/data`)\n            .then((response) => {\n                setLoader(false);\n                if (response.data) {\n                    const plans = response.data.plans.filter((data) => {\n                        return data.hasOwnProperty(\n                            \"supportedByIbmConfigurator\"\n                        );\n                    });\n                    setPlans(plans);\n                }\n            })\n            .catch((err) => console.log(err));\n    };\n\n    /**\n     * @param  {} product\n     * @param  {} buttonId\n     */\n    const redirectToPurchase = (product, buttonId) => {\n        setProductName(product.name);\n        setClickedButton(buttonId);\n        setError(false);\n        setSpinner(true);\n\n        //order reference number not used on purchase flow,\n        // if there are any ORN left in session from previous subscrition actions... - remove them\n        sessionStorage.removeItem(\"or\");\n\n        axios\n            .post(\n                `${hostname}/partner/product/${urlProductID}/configure/${product.id}/${navigator.language}`\n            )\n            .then((res) => {\n                if (res.data.redirectUrl) {\n                    window.open(res.data.redirectUrl);\n                } else {\n                    setError(true);\n                }\n                setSpinner(false);\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n    };\n\n    /**\n     * @param  {} product\n     */\n    const buttonProps = (product) => {\n        return {\n            size: \"small\",\n            tooltipAlignment: \"center\",\n            onClick: () => redirectToPurchase(product, product.id + \"_PB\"),\n            className: \"purchase-button\",\n        };\n    };\n\n    const skeletTableProps = () => ({\n        headers,\n        columnCount: 3,\n        rowCount: 20,\n        zebra: true,\n        compact: false,\n        showHeader: true,\n        showToolbar: false,\n    });\n\n    const loadingProps = () => ({\n        active: spinner,\n        withOverlay: false,\n        small: true,\n        description: \"\",\n    });\n\n    const notificationProps = () => ({\n        kind: \"error\",\n        lowContrast: false,\n        role: \"alert\",\n        title: productName + \" is not supported.\",\n        subtitle: \"Please try again.\",\n        iconDescription: \"describes the close button\",\n        statusIconDescription: \"describes the status icon\",\n        hideCloseButton: false,\n        onCloseButtonClick: () => onCloseButtonClick(),\n    });\n\n    const onCloseButtonClick = () => setError(false);\n\n    return (\n        <ContainerComponent>\n            {error && <InlineNotification {...notificationProps()} />}\n\n            {loading ? (\n                <>\n                    <div style={{ width: \"auto\" }}>\n                        <DataTableSkeleton {...skeletTableProps()} />\n                        <br />\n                    </div>\n                </>\n            ) : (\n                <>\n                    <TableContainer\n                        title='Plans'\n                        description='Click configure to build desired configuration and order.'\n                    >\n                        <Table>\n                            <TableHead>\n                                <TableRow>\n                                    {headers.map((header) => (\n                                        <TableHeader key={header}>\n                                            {header}\n                                        </TableHeader>\n                                    ))}\n                                    <TableHeader></TableHeader>\n                                </TableRow>\n                            </TableHead>\n\n                            <TableBody>\n                                {plans.map((plan) => (\n                                    <TableRow key={plan.id}>\n                                        <TableCell>{plan.name}</TableCell>\n                                        <TableCell>\n                                            {plan.description}\n                                        </TableCell>\n                                        <TableCell>\n                                            <Button {...buttonProps(plan)}>\n                                                Purchase{\" \"}\n                                                {spinner &&\n                                                    plan.id + \"_PB\" ===\n                                                        clickedButton && (\n                                                        <Loading\n                                                            {...loadingProps()}\n                                                            className={\n                                                                \"some-class\"\n                                                            }\n                                                        />\n                                                    )}\n                                            </Button>\n                                        </TableCell>\n                                    </TableRow>\n                                ))}\n                            </TableBody>\n                        </Table>\n                    </TableContainer>\n                </>\n            )}\n        </ContainerComponent>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}